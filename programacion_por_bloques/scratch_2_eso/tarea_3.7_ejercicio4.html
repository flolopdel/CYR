<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scratch para la Paz: Gu√≠a Interactiva</title>
    <script src="/CYR/assets/tailwind.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');
        
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #fcfbf9; /* Warm neutral */
            color: #4a4a4a;
        }

        /* Chart Container Styling - Mandatory Strict Adherence */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Tailwind max-w-xl approx equivalent */
            margin-left: auto;
            margin-right: auto;
            height: 300px; 
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Scratch-like Block Styling */
        .scratch-block {
            padding: 8px 12px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            display: inline-block;
            margin: 2px 0;
            box-shadow: 0 2px 0 rgba(0,0,0,0.2);
            font-size: 0.9rem;
            cursor: default;
        }
        .block-event { background-color: #FFBF00; border: 1px solid #D9A200; }
        .block-control { background-color: #FFAB19; border: 1px solid #CF8B17; }
        .block-motion { background-color: #4C97FF; border: 1px solid #3373CC; }
        .block-looks { background-color: #9966FF; border: 1px solid #774DCB; }
        .block-sound { background-color: #CF63CF; border: 1px solid #BD42BD; }
        .block-variable { background-color: #FF8C1A; border: 1px solid #DB6E00; }
        .block-operator { background-color: #59C059; border: 1px solid #389438; }

        /* Animation specific */
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Custom Scrollbar for code areas */
        .code-scroll::-webkit-scrollbar { width: 8px; }
        .code-scroll::-webkit-scrollbar-track { background: #f1f1f1; }
        .code-scroll::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
    </style>
    <!-- Chosen Palette: Warm Neutrals & Education Brights. Background: #fcfbf9 (Off-white), Primary: #4C97FF (Scratch Blue), Accent: #FFAB19 (Scratch Orange), Text: #4a4a4a (Dark Gray). -->
    <!-- Application Structure Plan: 
         1. Hero Section: Sets the context for Peace Day (Jan 30) and the tool (Scratch).
         2. Project Explorer (Dashboard): A comparison view of the 4 project levels (Initial, Intermediate, Advanced, Creative) using a Radar Chart to help teachers choose based on class skills.
         3. Deep Dive "The Catcher Game": Focuses on the main request (Project 2).
            - Interactive Logic Map: Instead of static text, users click on game phases (Movement, Clones, Scoring) to see specific code blocks.
            - "Live" Logic Simulation: A JS Canvas element that REPLICATES the game logic visually. Users can "play" a simplified version to understand the "Coordinate System" and "Cloning" concepts before coding.
         4. Step-by-Step Builder: A tabbed interface breaking down the Project 2 code into digestible chunks.
         5. Footer: Credits and summary.
         This structure moves from "Why" -> "What" -> "How" (Conceptual) -> "How" (Technical). 
    -->
    <!-- Visualization & Content Choices:
         1. Competency Radar Chart: Goal: Inform/Compare. Method: Chart.js Radar. Justification: Teachers need to balance "Coding Difficulty" vs "Values Taught". Visualizes the 4 project ideas.
         2. Logic Simulator (Canvas): Goal: Change/Understand. Method: HTML5 Canvas + JS. Justification: Explaining "Clones" and "X/Y Coordinates" is abstract. A live interactive demo where the user moves a paddle and sees the X/Y values update helps them understand the *math* they need to code.
         3. Block Builder: Goal: Organize. Method: Styled HTML divs imitating Scratch blocks. Justification: Familiar visual language for Scratch users, far better than plain text code.
         4. Dynamic Text: Goal: Inform. Method: DOM manipulation. Justification: Contextual explanations update based on user interaction with the simulation.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üïäÔ∏è</span>
                <h1 class="text-xl font-bold text-gray-800 tracking-tight">EduPaz <span class="text-blue-500 font-normal">| Scratch Lab</span></h1>
            </div>
            <div class="hidden md:flex space-x-6 text-sm font-semibold text-gray-600">
                <a href="#ideas" class="hover:text-blue-500 transition">Ideas de Proyecto</a>
                <a href="#simulation" class="hover:text-blue-500 transition">Simulador de L√≥gica</a>
                <a href="#code" class="hover:text-blue-500 transition">Bloque a Bloque</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="bg-gradient-to-r from-blue-50 to-indigo-50 py-12 border-b border-gray-100">
        <div class="container mx-auto px-4 text-center max-w-3xl">
            <span class="inline-block px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-bold mb-4">30 Enero: D√≠a de la Paz</span>
            <h2 class="text-4xl md:text-5xl font-extrabold text-gray-800 mb-6 leading-tight">
                Programando Valores: <br>
                <span class="text-blue-600">Atrapando la Paz en Scratch</span>
            </h2>
            <p class="text-lg text-gray-600 mb-8">
                Transforma el aula en un taller de creadores de cambio. Una gu√≠a interactiva para dise√±ar videojuegos que fomentan la empat√≠a, la resoluci√≥n de conflictos y la paz.
            </p>
            <div class="flex justify-center gap-4">
                <a href="#ideas" class="bg-white text-gray-700 px-6 py-3 rounded-lg font-bold shadow hover:shadow-md transition border border-gray-200">Explorar Niveles</a>
                <a href="#simulation" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-bold shadow hover:bg-blue-700 transition">Ver Demo del Juego</a>
            </div>
        </div>
    </header>

    <!-- Section 1: Project Ideas & Comparison -->
    <section id="ideas" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="mb-10 max-w-3xl mx-auto text-center">
                <h3 class="text-2xl font-bold text-gray-800 mb-3">Selector de Proyectos</h3>
                <p class="text-gray-600">
                    No todos los grupos son iguales. Analizamos las 4 propuestas del reporte original bas√°ndonos en dificultad t√©cnica e impacto narrativo para ayudarte a elegir.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <!-- Text Cards -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <!-- Card 1 -->
                    <div class="p-5 border border-gray-100 rounded-xl shadow-sm hover:shadow-md transition bg-green-50 cursor-pointer project-card" onclick="updateRadar(0)">
                        <div class="text-2xl mb-2">üéà</div>
                        <h4 class="font-bold text-gray-800">1. Muro de Deseos</h4>
                        <p class="text-xs text-gray-500 mt-1">Nivel: Inicial</p>
                        <p class="text-sm text-gray-600 mt-2">Interacci√≥n simple clic-mensaje. Ideal para primeros pasos.</p>
                    </div>
                    <!-- Card 2 -->
                    <div class="p-5 border-l-4 border-blue-500 rounded-xl shadow-md bg-white cursor-pointer project-card ring-2 ring-blue-100" onclick="updateRadar(1)">
                        <div class="text-2xl mb-2">üïäÔ∏è</div>
                        <h4 class="font-bold text-gray-800">2. Atrapando Paz</h4>
                        <p class="text-xs text-blue-500 font-bold mt-1">Nivel: Intermedio (Recomendado)</p>
                        <p class="text-sm text-gray-600 mt-2">Juego tipo "catcher". Introduce variables, clones y condicionales.</p>
                    </div>
                    <!-- Card 3 -->
                    <div class="p-5 border border-gray-100 rounded-xl shadow-sm hover:shadow-md transition bg-purple-50 cursor-pointer project-card" onclick="updateRadar(2)">
                        <div class="text-2xl mb-2">üó£Ô∏è</div>
                        <h4 class="font-bold text-gray-800">3. Traductor</h4>
                        <p class="text-xs text-gray-500 mt-1">Nivel: Avanzado</p>
                        <p class="text-sm text-gray-600 mt-2">Uso de extensiones TTS y listas. Enfoque multicultural.</p>
                    </div>
                    <!-- Card 4 -->
                    <div class="p-5 border border-gray-100 rounded-xl shadow-sm hover:shadow-md transition bg-yellow-50 cursor-pointer project-card" onclick="updateRadar(3)">
                        <div class="text-2xl mb-2">üìñ</div>
                        <h4 class="font-bold text-gray-800">4. Storytelling</h4>
                        <p class="text-xs text-gray-500 mt-1">Nivel: Creativo</p>
                        <p class="text-sm text-gray-600 mt-2">Narrativa secuencial, sincronizaci√≥n y dise√±o de escenarios.</p>
                    </div>
                </div>

                <!-- Visualization -->
                <div class="bg-gray-50 rounded-2xl p-6 flex flex-col justify-center items-center">
                    <h5 class="text-sm font-bold text-gray-500 uppercase mb-4 tracking-wide">An√°lisis de Competencias</h5>
                    <div class="chart-container">
                        <canvas id="projectsRadar"></canvas>
                    </div>
                    <p class="text-center text-xs text-gray-400 mt-4">Haz clic en las tarjetas para comparar m√©tricas.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 2: Interactive Logic Simulator (The Core Request) -->
    <section id="simulation" class="py-16 bg-[#f4f7fa]">
        <div class="container mx-auto px-4">
            <div class="mb-8 text-center max-w-3xl mx-auto">
                <span class="text-blue-600 font-bold text-sm tracking-wider uppercase">Fase de Dise√±o</span>
                <h3 class="text-3xl font-bold text-gray-800 mt-2">Entendiendo la L√≥gica: "Atrapando la Paz"</h3>
                <p class="text-gray-600 mt-3">
                    Antes de colocar bloques en Scratch, es vital entender la mec√°nica. Este simulador muestra c√≥mo funciona internamente el juego. 
                    Mueve el rat√≥n sobre el lienzo para controlar al "Protagonista".
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                
                <!-- The Canvas Simulator -->
                <div class="lg:col-span-2 bg-white rounded-xl shadow-lg p-1 relative overflow-hidden group">
                    <div class="absolute top-4 left-4 z-10 bg-white/90 backdrop-blur px-3 py-1 rounded shadow text-sm font-bold text-gray-700">
                        Puntos: <span id="sim-score" class="text-blue-600 text-lg">0</span>
                    </div>
                    <canvas id="gameCanvas" class="w-full h-[400px] bg-gray-100 rounded cursor-crosshair touch-none"></canvas>
                    <div class="absolute bottom-4 left-0 w-full text-center pointer-events-none">
                        <p class="text-sm text-gray-400 bg-white/80 inline-block px-4 py-1 rounded-full">Mueve el cursor/dedo para atrapar palabras positivas</p>
                    </div>
                    <!-- Overlay for "Game Over" or Start -->
                    <div id="sim-overlay" class="absolute inset-0 bg-blue-900/10 flex items-center justify-center backdrop-blur-[1px]">
                        <button onclick="startGame()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition hover:scale-105">
                            ‚ñ∂ Iniciar Simulaci√≥n
                        </button>
                    </div>
                </div>

                <!-- Dynamic Logic explainer -->
                <div class="bg-white rounded-xl shadow p-6 flex flex-col justify-between">
                    <div>
                        <h4 class="font-bold text-gray-800 text-lg mb-4 flex items-center">
                            <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse mr-2"></span>
                            Monitor de L√≥gica
                        </h4>
                        
                        <div id="logic-log" class="space-y-3">
                            <!-- Dynamic Content will appear here -->
                            <div class="p-3 bg-gray-50 rounded border-l-4 border-gray-300">
                                <p class="text-xs text-gray-500 uppercase font-bold">Estado</p>
                                <p class="text-sm text-gray-700">Esperando inicio...</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 border-t pt-4">
                        <h5 class="text-sm font-bold text-gray-600 mb-2">Variables Activas</h5>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div class="bg-blue-50 p-2 rounded">
                                <span class="block text-xs text-blue-400">X Rat√≥n</span>
                                <span id="debug-x" class="font-mono font-bold text-blue-800">0</span>
                            </div>
                            <div class="bg-purple-50 p-2 rounded">
                                <span class="block text-xs text-purple-400">Objetos (Clones)</span>
                                <span id="debug-clones" class="font-mono font-bold text-purple-800">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 3: Code Construction (Step by Step) -->
    <section id="code" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-10">
                    <h3 class="text-2xl font-bold text-gray-800">Construye el C√≥digo</h3>
                    <p class="text-gray-600">Paso a paso para programar "Atrapando la Paz". Utiliza los bloques de colores como referencia.</p>
                </div>

                <!-- Tabs -->
                <div class="flex flex-wrap justify-center gap-2 mb-8">
                    <button class="px-5 py-2 rounded-full font-bold text-sm bg-blue-100 text-blue-700 border border-blue-200" onclick="showStep('step1', this)">1. El Protagonista</button>
                    <button class="px-5 py-2 rounded-full font-bold text-sm bg-white text-gray-600 border border-gray-200 hover:bg-gray-50" onclick="showStep('step2', this)">2. Lluvia de Objetos</button>
                    <button class="px-5 py-2 rounded-full font-bold text-sm bg-white text-gray-600 border border-gray-200 hover:bg-gray-50" onclick="showStep('step3', this)">3. Puntos y Choques</button>
                    <button class="px-5 py-2 rounded-full font-bold text-sm bg-white text-gray-600 border border-gray-200 hover:bg-gray-50" onclick="showStep('step4', this)">4. Ambientaci√≥n</button>
                </div>

                <!-- Code Container -->
                <div class="bg-gray-50 border border-gray-200 rounded-2xl p-6 md:p-10 min-h-[400px]">
                    
                    <!-- STEP 1: Protagonist -->
                    <div id="step1" class="step-content fade-in">
                        <div class="flex flex-col md:flex-row gap-8">
                            <div class="md:w-1/2">
                                <h4 class="text-xl font-bold text-gray-800 mb-3">Movimiento Lateral</h4>
                                <p class="text-sm text-gray-600 mb-4">
                                    El personaje principal (la Paloma) debe seguir el movimiento del rat√≥n, pero solo horizontalmente (eje X).
                                </p>
                                <ul class="list-disc list-inside text-sm text-gray-600 space-y-1 bg-white p-4 rounded shadow-sm">
                                    <li>Selecciona el objeto <strong>Paloma</strong>.</li>
                                    <li>Usamos un bucle infinito para que siempre reaccione.</li>
                                    <li>Fijamos 'y' (altura) para que no suba ni baje.</li>
                                </ul>
                            </div>
                            <div class="md:w-1/2 bg-white p-6 rounded-xl shadow-inner border border-gray-100 code-scroll overflow-y-auto max-h-[300px]">
                                <div class="scratch-block block-event">al hacer clic en üè≥Ô∏è</div><br>
                                <div class="scratch-block block-motion">ir a x: 0 y: -140</div><br>
                                <div class="scratch-block block-control">por siempre</div>
                                <div class="ml-4 border-l-2 border-gray-300 pl-2">
                                    <div class="scratch-block block-motion">fijar x a <span class="scratch-block block-operator py-0 px-1 text-xs">posici√≥n x del rat√≥n</span></div>
                                </div>
                                <div class="scratch-block block-control opacity-50">fin</div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 2: Clones -->
                    <div id="step2" class="step-content hidden fade-in">
                        <div class="flex flex-col md:flex-row gap-8">
                            <div class="md:w-1/2">
                                <h4 class="text-xl font-bold text-gray-800 mb-3">Generador de Clones</h4>
                                <p class="text-sm text-gray-600 mb-4">
                                    Para no crear 100 objetos, creamos "fantasmas" (clones) de un solo objeto original. Esto ahorra memoria y trabajo.
                                </p>
                                <div class="bg-yellow-50 p-3 rounded border border-yellow-200 text-xs text-yellow-800 mb-2">
                                    <strong>Tip:</strong> Oculta el objeto original al principio para que no se quede est√°tico en medio de la pantalla.
                                </div>
                            </div>
                            <div class="md:w-1/2 bg-white p-6 rounded-xl shadow-inner border border-gray-100 code-scroll overflow-y-auto max-h-[300px]">
                                <div class="scratch-block block-event">al hacer clic en üè≥Ô∏è</div><br>
                                <div class="scratch-block block-looks">ocultar</div><br>
                                <div class="scratch-block block-control">por siempre</div>
                                <div class="ml-4 border-l-2 border-gray-300 pl-2">
                                    <div class="scratch-block block-control">crear clon de <span class="scratch-block block-control py-0 px-1 text-xs">m√≠ mismo</span></div><br>
                                    <div class="scratch-block block-control">esperar (1) segundos</div>
                                </div><br><br>
                                
                                <div class="scratch-block block-control">al comenzar como clon</div><br>
                                <div class="scratch-block block-motion">ir a x: <span class="scratch-block block-operator py-0 px-1 text-xs">n√∫mero aleatorio entre -200 y 200</span> y: 180</div><br>
                                <div class="scratch-block block-looks">mostrar</div><br>
                                <div class="scratch-block block-looks">cambiar disfraz a <span class="scratch-block block-operator py-0 px-1 text-xs">n√∫mero aleatorio entre 1 y 3</span></div><br>
                                <div class="scratch-block block-control">por siempre</div>
                                <div class="ml-4 border-l-2 border-gray-300 pl-2">
                                    <div class="scratch-block block-motion">sumar a y (-5)</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 3: Scoring -->
                    <div id="step3" class="step-content hidden fade-in">
                        <div class="flex flex-col md:flex-row gap-8">
                            <div class="md:w-1/2">
                                <h4 class="text-xl font-bold text-gray-800 mb-3">Colisiones y Puntos</h4>
                                <p class="text-sm text-gray-600 mb-4">
                                    Detectamos si el clon toca a la Paloma o si toca el suelo.
                                </p>
                                <ul class="list-disc list-inside text-sm text-gray-600 space-y-1">
                                    <li>Si toca <strong>Paloma</strong>: Sumar punto, sonido y borrar clon.</li>
                                    <li>Si toca <strong>Borde inferior</strong> (Y < -170): Borrar clon (para limpiar pantalla).</li>
                                </ul>
                            </div>
                            <div class="md:w-1/2 bg-white p-6 rounded-xl shadow-inner border border-gray-100 code-scroll overflow-y-auto max-h-[300px]">
                                <p class="text-xs text-gray-400 mb-2">// Dentro del "por siempre" del clon</p>
                                <div class="scratch-block block-control">si <span class="scratch-block block-operator py-0 px-1 text-xs">¬øtocando a Paloma?</span> entonces</div>
                                <div class="ml-4 border-l-2 border-gray-300 pl-2">
                                    <div class="scratch-block block-sound">iniciar sonido [Pop]</div><br>
                                    <div class="scratch-block block-variable">sumar a [Puntos] (1)</div><br>
                                    <div class="scratch-block block-control">eliminar este clon</div>
                                </div><br>
                                <div class="scratch-block block-control">si <span class="scratch-block block-operator py-0 px-1 text-xs">posici√≥n y < -170</span> entonces</div>
                                <div class="ml-4 border-l-2 border-gray-300 pl-2">
                                    <div class="scratch-block block-control">eliminar este clon</div>
                                </div>
                            </div>
                        </div>
                    </div>

                     <!-- STEP 4: Ambience -->
                     <div id="step4" class="step-content hidden fade-in">
                        <div class="flex flex-col md:flex-row gap-8">
                            <div class="md:w-1/2">
                                <h4 class="text-xl font-bold text-gray-800 mb-3">Efectos Visuales</h4>
                                <p class="text-sm text-gray-600 mb-4">
                                    Hagamos que el mundo reaccione. Si hay m√°s puntos de paz, el mundo brilla m√°s.
                                </p>
                                <p class="text-sm text-gray-600">
                                    Usa el bloque de efectos gr√°ficos en el <strong>Escenario</strong>.
                                </p>
                            </div>
                            <div class="md:w-1/2 bg-white p-6 rounded-xl shadow-inner border border-gray-100 code-scroll overflow-y-auto max-h-[300px]">
                                <div class="scratch-block block-event">al hacer clic en üè≥Ô∏è</div><br>
                                <div class="scratch-block block-variable">dar a [Puntos] el valor (0)</div><br>
                                <div class="scratch-block block-control">por siempre</div>
                                <div class="ml-4 border-l-2 border-gray-300 pl-2">
                                    <div class="scratch-block block-looks">fijar efecto [brillo] a <span class="scratch-block block-operator py-0 px-1 text-xs">Puntos * 2</span></div>
                                    <div class="text-xs text-gray-400 italic mt-1">// M√°s puntos = M√°s luz</div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-400 py-8">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2">Desarrollado para el D√≠a Escolar de la No Violencia y la Paz (30 Enero).</p>
            <p class="text-xs">Basado en la gu√≠a did√°ctica "Atrapando la Paz".</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // --- 1. Project Selector Radar Chart ---
        const ctx = document.getElementById('projectsRadar').getContext('2d');
        const dataConfig = {
            labels: ['Dificultad C√≥digo', 'Creatividad', 'Impacto Valores', 'Interacci√≥n'],
            datasets: [{
                label: 'M√©tricas del Proyecto',
                data: [4, 2, 3, 2], // Default: Project 2
                backgroundColor: 'rgba(76, 151, 255, 0.2)',
                borderColor: 'rgba(76, 151, 255, 1)',
                borderWidth: 2,
                pointBackgroundColor: '#fff',
                pointBorderColor: '#FFAB19'
            }]
        };

        const radarChart = new Chart(ctx, {
            type: 'radar',
            data: dataConfig,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        angleLines: { color: '#eee' },
                        grid: { color: '#eee' },
                        suggestedMin: 0,
                        suggestedMax: 5,
                        ticks: { display: false }
                    }
                },
                plugins: {
                    legend: { display: false }
                }
            }
        });

        const projectData = [
            [2, 3, 4, 2], // Initial
            [4, 2, 3, 4], // Intermediate (Current Default)
            [5, 3, 5, 3], // Advanced
            [3, 5, 4, 1]  // Creative
        ];

        function updateRadar(index) {
            // Update UI highlight
            document.querySelectorAll('.project-card').forEach((card, i) => {
                if(i === index) {
                    card.classList.add('ring-2', 'ring-blue-100', 'border-blue-500');
                    card.classList.remove('border-gray-100');
                } else {
                    card.classList.remove('ring-2', 'ring-blue-100', 'border-blue-500');
                    card.classList.add('border-gray-100');
                }
            });

            // Update Chart
            radarChart.data.datasets[0].data = projectData[index];
            radarChart.update();
        }

        // --- 2. Logic Simulation (The Game Logic Demo) ---
        const canvas = document.getElementById('gameCanvas');
        const c = canvas.getContext('2d');
        const scoreEl = document.getElementById('sim-score');
        const logEl = document.getElementById('logic-log');
        const debugX = document.getElementById('debug-x');
        const debugClones = document.getElementById('debug-clones');

        // Resize handling
        function resizeCanvas() {
            const rect = canvas.parentElement.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 400; // Fixed height match styling
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        let gameActive = false;
        let score = 0;
        let animationId;
        let objects = []; // The "Clones"
        let spawnTimer = 0;
        let mouseX = canvas.width / 2;

        // Player (Paddle/Dove)
        const player = {
            y: 350,
            width: 50,
            height: 50,
            color: '#4C97FF'
        };

        // Inputs
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
            debugX.innerText = Math.round(mouseX);
        });
        // Touch support
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            mouseX = e.touches[0].clientX - rect.left;
            debugX.innerText = Math.round(mouseX);
        }, { passive: false });


        function logEvent(type, msg) {
            const colorClass = type === 'good' ? 'border-green-300 bg-green-50' : (type === 'bad' ? 'border-red-300 bg-red-50' : 'border-gray-300 bg-gray-50');
            const html = `
                <div class="p-2 rounded border-l-4 ${colorClass} text-xs mb-2 fade-in">
                    <span class="font-bold block uppercase mb-1 opacity-70">${type}</span>
                    ${msg}
                </div>
            `;
            logEl.insertAdjacentHTML('afterbegin', html);
            if(logEl.children.length > 4) logEl.lastElementChild.remove();
        }

        class FallingObject {
            constructor() {
                this.x = Math.random() * (canvas.width - 40) + 20;
                this.y = -30;
                this.speed = Math.random() * 2 + 2;
                this.type = Math.random() > 0.3 ? 'good' : 'bad'; // 70% good
                this.text = this.type === 'good' ? ['Amor', 'Paz', 'Respeto'][Math.floor(Math.random()*3)] : ['Odio', 'Grito'][Math.floor(Math.random()*2)];
            }

            update() {
                this.y += this.speed;
            }

            draw() {
                c.font = "20px Nunito";
                c.fillStyle = this.type === 'good' ? '#4CAF50' : '#F44336';
                c.fillText(this.text, this.x, this.y);
            }
        }

        function startGame() {
            if (gameActive) return;
            gameActive = true;
            score = 0;
            scoreEl.innerText = score;
            objects = [];
            document.getElementById('sim-overlay').style.display = 'none';
            logEvent('info', 'Inicio: Bucle "Por Siempre" activado.');
            animate();
        }

        function animate() {
            if (!gameActive) return;
            animationId = requestAnimationFrame(animate);
            c.clearRect(0, 0, canvas.width, canvas.height);

            // 1. Draw Player (Dove logic)
            // Logic: Set X to Mouse X
            let playerX = mouseX - player.width/2;
            // Boundary checks
            if (playerX < 0) playerX = 0;
            if (playerX + player.width > canvas.width) playerX = canvas.width - player.width;

            // Draw simple "Dove" representation
            c.fillStyle = player.color;
            c.beginPath();
            c.arc(playerX + 25, player.y + 25, 25, 0, Math.PI*2);
            c.fill();
            c.fillStyle = "white";
            c.fillText("üïäÔ∏è", playerX + 10, player.y + 32);

            // 2. Spawn Objects logic
            spawnTimer++;
            if (spawnTimer > 60) { // Every ~1 second
                objects.push(new FallingObject());
                debugClones.innerText = objects.length;
                spawnTimer = 0;
            }

            // 3. Update & Draw Objects
            objects.forEach((obj, index) => {
                obj.update();
                obj.draw();

                // Collision Detection Logic
                const dist = Math.hypot(obj.x - (playerX+25), obj.y - (player.y+25));
                
                // Touched Player?
                if (dist < 35) {
                    if (obj.type === 'good') {
                        score++;
                        logEvent('good', `Si <tocando Paloma?>: Puntos + 1 (${score})`);
                    } else {
                        score -= 2;
                        logEvent('bad', `Si <tocando Paloma?>: Puntos - 2 (${score})`);
                    }
                    scoreEl.innerText = score;
                    objects.splice(index, 1);
                    debugClones.innerText = objects.length;
                }
                // Touched Bottom?
                else if (obj.y > canvas.height) {
                    objects.splice(index, 1);
                    debugClones.innerText = objects.length;
                    // Note: Not logging this to keep UI clean, but logic exists
                }
            });
        }


        // --- 3. Step Tab Logic ---
        function showStep(stepId, btn) {
            // Hide all steps
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(stepId).classList.remove('hidden');

            // Reset button styles
            const allBtns = btn.parentElement.querySelectorAll('button');
            allBtns.forEach(b => {
                b.classList.remove('bg-blue-100', 'text-blue-700', 'border-blue-200');
                b.classList.add('bg-white', 'text-gray-600', 'border-gray-200');
            });

            // Highlight active
            btn.classList.remove('bg-white', 'text-gray-600', 'border-gray-200');
            btn.classList.add('bg-blue-100', 'text-blue-700', 'border-blue-200');
        }

    </script>
</body>
</html>